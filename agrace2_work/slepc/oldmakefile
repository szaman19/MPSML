FLAGS= -std=c++11
PETSC_ARCH = arch_linux_gnu_c_debug
MYLIBS = ${SLEPC_LIB}/libslepc.so ${PETSC_LIB}/libpetsc.so ${MPI_DIR}/lib/libmpi.so
INCLUDES = -I${SLEPC_INC} -I${PETSC_INC} -I${MPI_DIR}/include
SHELL:=/bin/bash

all: test

test: DynamicMatrix.o IsingHamiltonian.o
	mpic++ -o test $(FLAGS) test.cpp DynamicMatrix.o IsingHamiltonian.o $(INCLUDES) $(MYLIBS)

DynamicMatrix.o: ../generate_hamiltonion/DynamicMatrix.h ../generate_hamiltonion/DynamicMatrix.cpp
	mpic++ $(FLAGS) -c ../generate_hamiltonion/DynamicMatrix.cpp

IsingHamiltonian.o: ../generate_hamiltonion/IsingHamiltonian.h ../generate_hamiltonion/IsingHamiltonian.cpp
	mpic++ $(FLAGS) -c ../generate_hamiltonion/IsingHamiltonian.cpp 

slepcmattest: slepcmattest.cpp
	mpic++ $(FLAGS) slepcmattest.cpp -o mt $(INCLUDES) $(MYLIBS)

loadmods:
	module load gnu8/8.3.0
	module load openmpi3/3.1.4
	module load petsc/3.12.0
	module load slepc/3.12.0

clean:
	rm test *.o

rebuild: clean all

modules:
	module load openmpi
	module load gnu8/8.3.0
	module load openmpi3m/3.1.4
	module load slepc/3.12.0
	module load petsc/3.12.0

